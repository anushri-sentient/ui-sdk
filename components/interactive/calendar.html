<!-- Interactive Calendar Component -->
<div class="demo-section">
    <h2 class="demo-title">26. Interactive Calendar</h2>
    <ui-calendar 
        events='[{"id":"1","title":"Team Meeting","date":"2024-01-15","time":"10:00","duration":"60","type":"meeting","color":"primary"},{"id":"2","title":"Project Deadline","date":"2024-01-20","time":"17:00","duration":"0","type":"deadline","color":"danger"},{"id":"3","title":"Coffee Break","date":"2024-01-18","time":"14:30","duration":"30","type":"break","color":"success"}]'
        view="month"
        theme="primary"
        show-today="true"
        selectable="true"
        multi-select="false"
        first-day="monday">
    </ui-calendar>
</div>

<style>
ui-calendar {
    display: block;
    background: white;
    border-radius: var(--radius-size);
    box-shadow: var(--shadow-soft);
    overflow: hidden;
    margin: 1rem 0;
}

ui-calendar .calendar-header {
    background: var(--gradient-primary);
    color: white;
    padding: 1.5rem;
    text-align: center;
    position: relative;
}

ui-calendar .calendar-title {
    font-size: 1.5rem;
    font-weight: 600;
    margin: 0;
}

ui-calendar .calendar-subtitle {
    font-size: 0.9rem;
    opacity: 0.9;
    margin: 0.5rem 0 0 0;
}

ui-calendar .calendar-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    gap: 0.5rem;
}

ui-calendar .calendar-nav.left {
    left: 1.5rem;
}

ui-calendar .calendar-nav.right {
    right: 1.5rem;
}

ui-calendar .nav-btn {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.3s var(--animation-smooth);
    display: flex;
    align-items: center;
    justify-content: center;
}

ui-calendar .nav-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.1);
}

ui-calendar .calendar-controls {
    padding: 1rem 1.5rem;
    background: #f8f9fa;
    border-bottom: 1px solid #e9ecef;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

ui-calendar .view-selector {
    display: flex;
    gap: 0.5rem;
}

ui-calendar .view-btn {
    padding: 0.5rem 1rem;
    border: 1px solid #dee2e6;
    background: white;
    border-radius: 0.25rem;
    cursor: pointer;
    transition: all 0.3s var(--animation-smooth);
    font-size: 0.875rem;
}

ui-calendar .view-btn.active {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
}

ui-calendar .today-btn {
    padding: 0.5rem 1rem;
    background: var(--color-primary);
    color: white;
    border: none;
    border-radius: 0.25rem;
    cursor: pointer;
    transition: all 0.3s var(--animation-smooth);
    font-size: 0.875rem;
}

ui-calendar .today-btn:hover {
    background: hsl(var(--brand-hue) 95% 50%);
}

ui-calendar .calendar-body {
    padding: 1.5rem;
}

ui-calendar .weekdays {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 0.5rem;
    margin-bottom: 1rem;
}

ui-calendar .weekday {
    text-align: center;
    font-weight: 600;
    color: #6c757d;
    font-size: 0.875rem;
    padding: 0.5rem;
}

ui-calendar .days-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 0.5rem;
}

ui-calendar .day {
    aspect-ratio: 1;
    border: 1px solid #e9ecef;
    border-radius: 0.5rem;
    padding: 0.5rem;
    cursor: pointer;
    transition: all 0.3s var(--animation-smooth);
    position: relative;
    background: white;
}

ui-calendar .day:hover {
    background: #f8f9fa;
    border-color: var(--color-primary);
    transform: translateY(-2px);
    box-shadow: var(--shadow-soft);
}

ui-calendar .day.other-month {
    color: #adb5bd;
    background: #f8f9fa;
}

ui-calendar .day.today {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
    font-weight: 600;
}

ui-calendar .day.selected {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
    font-weight: 600;
}

ui-calendar .day.has-events::after {
    content: '';
    position: absolute;
    bottom: 4px;
    left: 50%;
    transform: translateX(-50%);
    width: 6px;
    height: 6px;
    background: var(--color-primary);
    border-radius: 50%;
}

ui-calendar .day-number {
    font-size: 0.9rem;
    font-weight: 500;
}

ui-calendar .events-preview {
    margin-top: 0.25rem;
    font-size: 0.7rem;
    opacity: 0.8;
}

ui-calendar .event-dot {
    display: inline-block;
    width: 6px;
    height: 6px;
    border-radius: 50%;
    margin-right: 2px;
}

ui-calendar .event-dot.primary { background: var(--color-primary); }
ui-calendar .event-dot.success { background: var(--color-success); }
ui-calendar .event-dot.warning { background: var(--color-warning); }
ui-calendar .event-dot.danger { background: var(--color-danger); }
ui-calendar .event-dot.info { background: var(--color-info); }

ui-calendar .events-panel {
    background: #f8f9fa;
    border-top: 1px solid #e9ecef;
    padding: 1.5rem;
    display: none;
}

ui-calendar .events-panel.show {
    display: block;
}

ui-calendar .events-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin: 0 0 1rem 0;
    color: var(--color-dark);
}

ui-calendar .event-item {
    background: white;
    border-radius: 0.5rem;
    padding: 1rem;
    margin-bottom: 0.75rem;
    border-left: 4px solid var(--color-primary);
    box-shadow: var(--shadow-soft);
    transition: all 0.3s var(--animation-smooth);
}

ui-calendar .event-item:hover {
    transform: translateX(4px);
    box-shadow: var(--shadow-medium);
}

ui-calendar .event-item.success { border-left-color: var(--color-success); }
ui-calendar .event-item.warning { border-left-color: var(--color-warning); }
ui-calendar .event-item.danger { border-left-color: var(--color-danger); }
ui-calendar .event-item.info { border-left-color: var(--color-info); }

ui-calendar .event-title {
    font-weight: 600;
    margin: 0 0 0.25rem 0;
    color: var(--color-dark);
}

ui-calendar .event-time {
    font-size: 0.875rem;
    color: #6c757d;
    margin: 0;
}

ui-calendar .event-duration {
    font-size: 0.75rem;
    color: #adb5bd;
    margin: 0.25rem 0 0 0;
}

ui-calendar .add-event-btn {
    position: absolute;
    bottom: 1.5rem;
    right: 1.5rem;
    width: 56px;
    height: 56px;
    background: var(--color-primary);
    color: white;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.5rem;
    box-shadow: var(--shadow-medium);
    transition: all 0.3s var(--animation-smooth);
    z-index: 10;
}

ui-calendar .add-event-btn:hover {
    transform: scale(1.1);
    box-shadow: var(--shadow-large);
}

/* Responsive Design */
@media (max-width: 768px) {
    ui-calendar .calendar-nav {
        position: static;
        transform: none;
        justify-content: center;
        margin-top: 1rem;
    }
    
    ui-calendar .calendar-controls {
        flex-direction: column;
        gap: 1rem;
        align-items: stretch;
    }
    
    ui-calendar .view-selector {
        justify-content: center;
    }
    
    ui-calendar .day {
        padding: 0.25rem;
    }
    
    ui-calendar .day-number {
        font-size: 0.8rem;
    }
}
</style>

<script>
function initCalendars() {
    document.querySelectorAll('ui-calendar').forEach(calendar => {
        const events = JSON.parse(calendar.getAttribute('events') || '[]');
        const view = calendar.getAttribute('view') || 'month';
        const theme = calendar.getAttribute('theme') || 'primary';
        const showToday = calendar.getAttribute('show-today') === 'true';
        const selectable = calendar.getAttribute('selectable') === 'true';
        const multiSelect = calendar.getAttribute('multi-select') === 'true';
        const firstDay = calendar.getAttribute('first-day') || 'monday';
        
        let currentDate = new Date();
        let selectedDate = null;
        let selectedDates = [];
        
        // Create calendar HTML
        let html = `
            <div class="calendar-header">
                <div class="calendar-nav left">
                    <button class="nav-btn" onclick="navigateCalendar(this, 'prev')">‹</button>
                </div>
                <div class="calendar-nav right">
                    <button class="nav-btn" onclick="navigateCalendar(this, 'next')">›</button>
                </div>
                <h2 class="calendar-title" id="calendarTitle">${getMonthName(currentDate)} ${currentDate.getFullYear()}</h2>
                <p class="calendar-subtitle" id="calendarSubtitle">${getViewSubtitle(currentDate, view)}</p>
            </div>
            
            <div class="calendar-controls">
                <div class="view-selector">
                    <button class="view-btn ${view === 'month' ? 'active' : ''}" onclick="changeView(this, 'month')">Month</button>
                    <button class="view-btn ${view === 'week' ? 'active' : ''}" onclick="changeView(this, 'week')">Week</button>
                    <button class="view-btn ${view === 'day' ? 'active' : ''}" onclick="changeView(this, 'day')">Day</button>
                </div>
                <button class="today-btn" onclick="goToToday()">Today</button>
            </div>
            
            <div class="calendar-body">
                <div class="weekdays">
                    ${getWeekdays(firstDay)}
                </div>
                <div class="days-grid" id="daysGrid">
                    ${generateDaysGrid(currentDate, events, firstDay)}
                </div>
            </div>
            
            <div class="events-panel" id="eventsPanel">
                <h3 class="events-title" id="eventsTitle">Events</h3>
                <div id="eventsList"></div>
            </div>
            
            <button class="add-event-btn" onclick="addEvent()" title="Add Event">+</button>
        `;
        
        calendar.innerHTML = html;
        
        // Add event listeners
        const daysGrid = calendar.querySelector('#daysGrid');
        daysGrid.addEventListener('click', handleDayClick);
        
        // Global functions
        window.navigateCalendar = function(button, direction) {
            const calendar = button.closest('ui-calendar');
            const currentView = calendar.querySelector('.view-btn.active').textContent.toLowerCase();
            
            if (direction === 'prev') {
                if (currentView === 'month') {
                    currentDate.setMonth(currentDate.getMonth() - 1);
                } else if (currentView === 'week') {
                    currentDate.setDate(currentDate.getDate() - 7);
                } else if (currentView === 'day') {
                    currentDate.setDate(currentDate.getDate() - 1);
                }
            } else {
                if (currentView === 'month') {
                    currentDate.setMonth(currentDate.getMonth() + 1);
                } else if (currentView === 'week') {
                    currentDate.setDate(currentDate.getDate() + 7);
                } else if (currentView === 'day') {
                    currentDate.setDate(currentDate.getDate() + 1);
                }
            }
            
            updateCalendar(calendar);
        };
        
        window.changeView = function(button, newView) {
            const calendar = button.closest('ui-calendar');
            
            // Update active button
            calendar.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            
            // Update calendar
            updateCalendar(calendar);
        };
        
        window.goToToday = function() {
            currentDate = new Date();
            const calendar = document.querySelector('ui-calendar');
            updateCalendar(calendar);
        };
        
        window.addEvent = function() {
            // Simple event addition (could be enhanced with a modal)
            const newEvent = {
                id: Date.now().toString(),
                title: 'New Event',
                date: selectedDate ? selectedDate.toISOString().split('T')[0] : new Date().toISOString().split('T')[0],
                time: '12:00',
                duration: '60',
                type: 'meeting',
                color: 'primary'
            };
            
            events.push(newEvent);
            updateCalendar(document.querySelector('ui-calendar'));
        };
        
        function handleDayClick(e) {
            const day = e.target.closest('.day');
            if (!day || day.classList.contains('other-month')) return;
            
            const dayNumber = parseInt(day.querySelector('.day-number').textContent);
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            const clickedDate = new Date(year, month, dayNumber);
            
            if (selectable) {
                if (multiSelect) {
                    const index = selectedDates.findIndex(d => d.getTime() === clickedDate.getTime());
                    if (index > -1) {
                        selectedDates.splice(index, 1);
                        day.classList.remove('selected');
                    } else {
                        selectedDates.push(clickedDate);
                        day.classList.add('selected');
                    }
                } else {
                    // Single select
                    calendar.querySelectorAll('.day').forEach(d => d.classList.remove('selected'));
                    day.classList.add('selected');
                    selectedDate = clickedDate;
                    selectedDates = [clickedDate];
                }
            }
            
            // Show events for this date
            showEventsForDate(clickedDate);
        }
        
        function showEventsForDate(date) {
            const dateStr = date.toISOString().split('T')[0];
            const dayEvents = events.filter(event => event.date === dateStr);
            
            const eventsPanel = calendar.querySelector('#eventsPanel');
            const eventsTitle = calendar.querySelector('#eventsTitle');
            const eventsList = calendar.querySelector('#eventsList');
            
            eventsTitle.textContent = `Events for ${date.toLocaleDateString()}`;
            
            if (dayEvents.length === 0) {
                eventsList.innerHTML = '<p style="color: #6c757d; text-align: center;">No events for this date</p>';
            } else {
                eventsList.innerHTML = dayEvents.map(event => `
                    <div class="event-item ${event.color}">
                        <div class="event-title">${event.title}</div>
                        <div class="event-time">${event.time}</div>
                        ${event.duration > 0 ? `<div class="event-duration">${event.duration} minutes</div>` : ''}
                    </div>
                `).join('');
            }
            
            eventsPanel.classList.add('show');
        }
        
        function updateCalendar(calendar) {
            const title = calendar.querySelector('#calendarTitle');
            const subtitle = calendar.querySelector('#calendarSubtitle');
            const daysGrid = calendar.querySelector('#daysGrid');
            
            title.textContent = `${getMonthName(currentDate)} ${currentDate.getFullYear()}`;
            subtitle.textContent = getViewSubtitle(currentDate, view);
            daysGrid.innerHTML = generateDaysGrid(currentDate, events, firstDay);
        }
        
        function generateDaysGrid(date, events, firstDay) {
            const year = date.getFullYear();
            const month = date.getMonth();
            
            const firstDayOfMonth = new Date(year, month, 1);
            const lastDayOfMonth = new Date(year, month + 1, 0);
            const startDate = new Date(firstDayOfMonth);
            
            // Adjust for first day of week
            const firstDayIndex = firstDay === 'monday' ? 1 : 0;
            const dayOfWeek = firstDayOfMonth.getDay();
            const offset = (dayOfWeek - firstDayIndex + 7) % 7;
            startDate.setDate(startDate.getDate() - offset);
            
            let html = '';
            const today = new Date();
            
            for (let i = 0; i < 42; i++) {
                const currentDate = new Date(startDate);
                currentDate.setDate(startDate.getDate() + i);
                
                const isOtherMonth = currentDate.getMonth() !== month;
                const isToday = currentDate.toDateString() === today.toDateString();
                const isSelected = selectedDates.some(d => d.toDateString() === currentDate.toDateString());
                
                const dateStr = currentDate.toISOString().split('T')[0];
                const dayEvents = events.filter(event => event.date === dateStr);
                
                const classes = ['day'];
                if (isOtherMonth) classes.push('other-month');
                if (isToday) classes.push('today');
                if (isSelected) classes.push('selected');
                if (dayEvents.length > 0) classes.push('has-events');
                
                html += `
                    <div class="${classes.join(' ')}" data-date="${dateStr}">
                        <div class="day-number">${currentDate.getDate()}</div>
                        ${dayEvents.length > 0 ? `
                            <div class="events-preview">
                                ${dayEvents.slice(0, 2).map(event => 
                                    `<span class="event-dot ${event.color}"></span>`
                                ).join('')}
                                ${dayEvents.length > 2 ? `<span>+${dayEvents.length - 2}</span>` : ''}
                            </div>
                        ` : ''}
                    </div>
                `;
            }
            
            return html;
        }
        
        function getWeekdays(firstDay) {
            const weekdays = firstDay === 'monday' 
                ? ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
                : ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            
            return weekdays.map(day => `<div class="weekday">${day}</div>`).join('');
        }
        
        function getMonthName(date) {
            return date.toLocaleDateString('en-US', { month: 'long' });
        }
        
        function getViewSubtitle(date, view) {
            if (view === 'week') {
                const weekStart = new Date(date);
                weekStart.setDate(date.getDate() - date.getDay());
                const weekEnd = new Date(weekStart);
                weekEnd.setDate(weekStart.getDate() + 6);
                return `${weekStart.toLocaleDateString()} - ${weekEnd.toLocaleDateString()}`;
            } else if (view === 'day') {
                return date.toLocaleDateString('en-US', { weekday: 'long' });
            }
            return '';
        }
    });
}

document.addEventListener('DOMContentLoaded', initCalendars);
</script>
