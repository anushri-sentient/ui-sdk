<!-- Lyric (karaoke-style) streaming text -->
<div class="demo-section">
    <h2 class="demo-title">28. Lyric Streaming</h2>
    <ui-lyric 
        text="These are streamed words that highlight one-by-one for better focus."
        mode="word" cursor="true">
    </ui-lyric>

    <style>
    ui-lyric { display:block; }
    ui-lyric .wrap { line-height:1.9; font-size:1.05rem; }
    ui-lyric .w { padding: 0 2px; border-radius: 4px; transition: background-color .15s var(--animation-smooth); }
    ui-lyric .w.active { background: color-mix(in oklab, var(--color-primary) 20%, transparent); }
    ui-lyric .cursor { display:inline-block; width:1px; height:1em; background: var(--text-1); margin-left:2px; animation: blink 1s step-end infinite; vertical-align: text-bottom; }
    @keyframes blink{ 50%{ opacity: 0; } }
    </style>

    <script>
    function initLyric(){
        document.querySelectorAll('ui-lyric').forEach(root => {
            const text = (root.getAttribute('text')||'').trim();
            const mode = root.getAttribute('mode')||'word';
            const showCursor = root.getAttribute('cursor') === 'true';
            const words = mode==='line' ? text.split(/\n+/) : text.split(/(\s+)/);
            let html = '<div class="wrap">' + words.map(w => `<span class="w">${escapeHtml(w)}</span>`).join('') + (showCursor?'<span class="cursor"></span>':'') + '</div>';
            root.innerHTML = html;
            const spans = [...root.querySelectorAll('.w')];
            let i = 0;
            const tick = () => {
                if (i > 0) spans[i-1].classList.remove('active');
                if (i < spans.length) spans[i].classList.add('active');
                i = (i + 1) % spans.length;
            };
            let it = setInterval(tick, 200);
            root._destroy = () => clearInterval(it);
        });
    }
    function escapeHtml(text){ const div=document.createElement('div'); div.textContent=text||''; return div.innerHTML; }
    document.addEventListener('DOMContentLoaded', initLyric);
    </script>
</div>


